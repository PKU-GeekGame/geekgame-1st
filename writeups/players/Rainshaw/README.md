| æ˜µç§°     | å…¬å¼€å£°æ˜   | License                                                      |
| -------- | ---------- | ------------------------------------------------------------ |
| Rainshaw | æ— æ¡ä»¶å…¬å¼€ | [çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®ï¼ˆCC BY-NC 4.0ï¼‰](http://creativecommons.org/licenses/by-nc/4.0/) |

[TOC]

## ç­¾åˆ°

### ç®€å•åšæ³•

åœ¨ Windows ç³»ç»Ÿä¸­ä½¿ç”¨ Edge æµè§ˆå™¨ï¼Œç›´æ¥åœ¨ä¸‹é¢ä¸¤è¡Œåˆ†åˆ«åŒå‡»ï¼Œé€‰ä¸­æ•´è¡Œï¼Œç„¶åå¤åˆ¶åˆ°æµè§ˆå™¨åœ°å€æ å³å¯å¾—åˆ°å¯¹åº”çš„æ˜æ–‡ã€‚ç„¶åå°†æ˜æ–‡æŒ‰ç…§åŸæœ‰é¡ºåºä¸Šä¸‹æ’åºï¼Œå³å¯å¾—åˆ° FLAG

### è¢«å‘åšæ³•

é¢˜ç›®åˆšæ”¾å‡ºæ¥çš„æ—¶å€™æˆ‘ç”¨çš„ Mac ç”µè„‘ã€‚ã€‚ã€‚æ­£å¦‚ç¬¬äºŒé˜¶æ®µæç¤ºï¼ŒSafari å’Œ Macç³»ç»Ÿè‡ªå¸¦çš„é¢„è§ˆ éƒ½æ— æ³•å®Œæ•´å¤åˆ¶æ•´è¡Œï¼Œå¯¼è‡´æˆ‘å¡äº†ä¸€ä¸‹åˆæ²¡åšå‡ºç­¾åˆ°é¢˜ï¼Œå¿ƒæ€å·®ç‚¹ç‚¸æ‰2333

å½“æ—¶ä½¿ç”¨ strings å‘½ä»¤çœ‹åˆ° PDF ä¸­æœ‰ä¸‹é¢è¿™ç§èŠ±ä½“å­—ç¬¦çš„å­—ä½“åæ˜¯`Wingdings-Regular`

![image-20211120120019550](WriteUp.assets/image-20211120120019550.png)

äºæ˜¯åœ¨ç½‘ä¸Šä¸‹è½½äº†è¿™ä¸ªå­—ä½“ï¼ŒæŒ¨ä¸ªæ¯”å¯¹ï¼Œå‘ç°å’Œå¤åˆ¶å‡ºæ¥çš„æ²¡å•¥åŒºåˆ«ï¼Œå¿ƒæ€çˆ†ç‚¸+1

## å°åŒ—é—®ç­”

| é¢˜ç›® | ç­”æ¡ˆ                                                 |
| ---- | ---------------------------------------------------- |
| 1    | 5                                                    |
| 2    | 407                                                  |
| 3    | 2021-07-11T08:49:53+08:00                            |
| 4    | OOO{this_is_the_welcome_flag}                        |
| 5    | 2933523260166137923998409309647057493882806525577536 |
| 6    | submits                                              |
| 7    | AS59201                                              |
| 8    | åŒºåŸŸå…‰çº¤é€šä¿¡ç½‘ä¸æ–°å‹å…‰é€šä¿¡ç³»ç»Ÿå›½å®¶é‡ç‚¹å®éªŒå®¤         |

1. åˆ©ç”¨é«˜å¾·åœ°å›¾æœç´¢ `åŒ—äº¬å¤§å­¦ç†ç§‘` ä¼šçœ‹åˆ° ç†ç§‘1å·æ¥¼ã€ç†ç§‘2å·æ¥¼å’Œç†ç§‘5å·æ¥¼ï¼Œï¼ˆéœ‡æƒŠğŸ¤¯è´µæ ¡ç«Ÿç„¶æœ‰ç†ç§‘5å·æ¥¼ï¼Œæˆ‘å‘†äº†5å¹´äº†æ‰çŸ¥é“ï¼‰ï¼Œå‘ç°æ²¡æœ‰4å’Œ6å·æ¥¼ï¼Œäºæ˜¯åˆ©ç”¨ç™¾åº¦æœç´¢ï¼Œå‘ç°4å·æ¥¼æ˜¯ç”Ÿç§‘ã€3å·æ¥¼æ˜¯æ¯…å¤«2æ¥¼ï¼Œå¹¶ä¸”æ²¡æœåˆ°6å·æ¥¼ã€‚
2. æˆ‘é¦–å…ˆæŸ¥çœ‹äº†[ç¬¬é›¶å±Šçš„ Github ä»“åº“](https://github.com/PKU-GeekGame/geekgame-0th) ä½†å¾ˆé—æ†¾åœ¨ä»“åº“é‡Œå¹¶æ²¡æœ‰æ‰¾åˆ°æ€»æ³¨å†Œäººæ•°ï¼Œåªæœ‰å‰100çš„æ¦œå•ã€‚äºæ˜¯æƒ³åˆ°è¿™ç§ä¸œè¥¿åº”è¯¥å¯ä»¥ç”¨æ¥å½°æ˜¾æˆç»©ï¼Œåœ¨å®£ä¼ çš„æ—¶å€™åº”è¯¥ä¼šç”¨åˆ°ï¼Œäºæ˜¯ç¿»äº†ç¿»ä¿¡ç§‘çš„å…¬ä¼—å·æ‰¾åˆ°æ¨é€ [https://mp.weixin.qq.com/s/voAN7LX655Hy5w3_cZmraA](https://mp.weixin.qq.com/s/voAN7LX655Hy5w3_cZmraA) é‡Œå†™ç€å…±407äººæ³¨å†Œã€æœ‰æ•ˆå‚ä¸äººæ•°334äººã€‚
3. å°è±¡ä¸­æœ‰ä¸ªç½‘ç«™èƒ½çœ‹æŸä¸ªåŸŸåç­¾å‘çš„æ‰€æœ‰å…è´¹è¯ä¹¦ï¼Œæ‰¾äº†å¥½ä¹…æ‰æ‰¾åˆ°è¿™ä¸ªç½‘ç«™ï¼Œ[https://crt.sh/](https://crt.sh/) ï¼Œç„¶åæœç´¢ `geekgame.pku.edu.cn` å³å¯çœ‹åˆ°å†å²ç­¾å‘
   ![image-20211120124023538](WriteUp.assets/image-20211120124023538.png)
   å¯ä»¥çœ‹åˆ°`4362003382` è¿™ä¸ªçš„è¿‡æœŸæ—¶é—´å’Œä¸‹ä¸€ä¸ªæ²¡æœ‰æ¥ä¸Šï¼Œå†è½¬æ¢ä¸€ä¸‹æ—¶é—´æ ¼å¼å³å¯ã€‚
4. ç¬¬å››é¢˜æ‰¾äº†å¥½ä¹…ï¼Œä¸»è¦æ˜¯ä¸€å¼€å§‹æ²¡æœå¯¹å…³é”®è¯ã€‚ã€‚ä¸€å¼€å§‹ç”¨çš„[https://rayhan0x01.github.io/ctf/2020/08/08/defcon-redteamvillage-ctf-tunneler-1,2,3,4,5,7,9.html](https://rayhan0x01.github.io/ctf/2020/08/08/defcon-redteamvillage-ctf-tunneler-1,2,3,4,5,7,9.html) è¿™ä¸ªFLAGï¼Œç»“æœåšå®Œå…¶ä»–çš„å‘ç°åªå¯¹äº†6ä¸ªï¼Œå†æ¬¡æŸ¥æ‰¾æ‰æ‰¾åˆ° DEFCON çš„å®˜æ–¹ [Pre-qualifier](https://oooverflow.io/dc-ctf-2020-quals/) ç½‘ç«™ï¼Œ ç„¶åè¿›å…¥[DC28Quals](https://scoreboard2020.oooverflow.io/#/) ç‚¹å‡»ä¸Šæ–¹ `Challenges` ä¸‹è½½ç¬¬ä¸€ä¸ªåŠ¨å›¾ä¸­çš„ txt å³å¯
   ![image-20211120124828409](WriteUp.assets/image-20211120124828409.png)
5. è¿™é—®å¡äº†å¥½ä¹…ï¼Œç”šè‡³å°è¯•æ‰‹åŠ¨è®¡ç®—å…¬å¼ï¼Œå†è€ƒè™‘åˆ°æ–œè¾¹çš„å¤šç§å¤æ‚æƒ…å†µåå†³å®šæ”¾å¼ƒï¼Œç»§ç»­æœç´¢ã€‚æ‰¾åˆ°[ç­”æ¡ˆ](http://oeis.org/A047659)åå¯¹ä¸–ç•Œæ•°å­¦å¤§å¸ˆæ„Ÿåˆ°éå¸¸éœ‡æ’¼ã€‚ã€‚ã€‚ä»–ç»™äº†ä¸€ä¸ª(m,n) æ£‹ç›˜ä¸Šè§£ä¸ªæ•°çš„å…¬å¼ï¼Œåˆ©ç”¨pythonæŠŠ `^`å¹‚è¿ç®—æ¢æˆ`**`ç„¶åç›´æ¥è®¡ç®—å³å¯ã€‚
6. è‚¯å®šè¦æ‰¾é¢˜ç›®æºç ï¼Œåˆ©ç”¨ç¬¬2é—®ä¸­æåˆ°çš„ [ç¬¬é›¶å±Šçš„ Github ä»“åº“](https://github.com/PKU-GeekGame/geekgame-0th) ï¼Œæ‰¾åˆ°å¯¹åº”çš„ [æºç ](https://github.com/PKU-GeekGame/geekgame-0th/blob/2bdf125d4fd408e68f8db977d48a3c495302a714/src/choice/game/db.py#L33) ï¼Œå½“æ—¶å…¶å®æ‰¾äº†ä¸€ä¼šå„¿ï¼Œä¸»è¦æ˜¯ä¸çŸ¥é“ `å°åŒ—é—®ç­”` çš„è‹±æ–‡åæ˜¯å“ªé“é¢˜ã€‚ã€‚ã€‚
7. åˆ©ç”¨ [ipip.net](https://www.ipip.net/ip.html) æŸ¥è¯¢è®¡ç®—ä¸­å¿ƒçš„ IP åœ°å€æ‰¾åˆ° 3ä¸ªASNï¼Œéšä¾¿ç‚¹è¿›ç¬¬ä¸€ä¸ªå‘ç° Org Name ä¸æ˜¯ PKUï¼Œåœ¨ Down Streams ä¸­æ‰¾åˆ°ä¸€ä¸ª Org Name ä¸º PKU çš„
8. ç¿»éä¿¡ç§‘çš„æ‰€æœ‰æœºæ„ï¼Œåˆ—äº†ä¸ªè¡¨ï¼Œæ‰¾å‡ºæœ€é•¿çš„æ˜¯`åŒºåŸŸå…‰çº¤é€šä¿¡ç½‘ä¸æ–°å‹å…‰é€šä¿¡ç³»ç»Ÿå›½å®¶é‡ç‚¹å®éªŒå®¤`



## å…±äº«çš„æœºå™¨

æ‰“å¼€é¢˜ç›®ï¼Œè·å¾—åç¼–è¯‘ä»£ç å¦‚ä¸‹ï¼š

```solidity
def storage:
  stor0 is addr at storage 0
  stor1 is uint256 at storage 1
  stor2 is uint256 at storage 2
  stor3 is uint256 at storage 3

def _fallback() payable: # default function
  revert

def unknown7fbf5e5a(uint256 _param1, uint256 _param2) payable: 
  require calldata.size - 4 >= 64
  if stor0 != caller:
      if stor0 != tx.origin:
          if stor1 != sha3(caller):
              if stor1 != sha3(tx.origin):
                  revert with 0, 'caller must be owner'
  stor2 = _param1
  stor3 = _param2

def unknownded0677d(uint256 _param1) payable: 
  require calldata.size - 4 >= 32
  idx = 0
  s = 0
  while idx < 64:
      idx = idx + 1
      s = s or (Mask(256, -4 * idx, _param1) >> 4 * idx) + (5 * idx) + (7 * Mask(256, -4 * idx, stor2) >> 4 * idx) % 16 << 4 * idx
      continue 
  if stor3 != 0:
      revert with 0, 'this is not the real flag!'
  return 1
```

å¯ä»¥çœ‹åˆ°å°±æ˜¯å¯¹è¾“å…¥çš„æ•°æ®å’Œ`stor2`è¿›è¡Œè¿ç®—åå†ä¸`stor3` æ¯”å¯¹ã€‚

è¿™é‡Œé‡åˆ°ä¸çŸ¥é“æ˜¯ä¸æ˜¯å‘ï¼Œä¸Šé¢çš„åç¼–è¯‘æ˜¯ `etherscan.io` ä¸Šçš„ï¼Œå’Œå…¶ä»–å·¥å…·å¾—åˆ°çš„åç¼–è¯‘ä»£ç æœ‰å¾®å°å·®åˆ«ï¼Œæˆ‘åšé¢˜æ—¶æ˜¯ç”¨çš„å…¶ä»–å·¥å…·çš„ç»“æœã€‚

é¦–å…ˆä½¿ç”¨ web3.py  å¾—åˆ° `store2` å’Œ `store3`ï¼š

```python
import web3
from web3 import Web3

w3 = Web3(Web3.HTTPProvider("https://ropsten.infura.io/v3/83ebfc92383e429a9ea26572d16ba7b9"))

print(w3.eth.get_storage_at("0xa43028c702c3B119C749306461582bF647Fd770a", 0))
b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00MR\x00\xa3W\x13\x91\xf3\xe6T\xdf\x15bq\xbf/\x01\xc0\xc5'

print(w3.eth.get_storage_at("0xa43028c702c3B119C749306461582bF647Fd770a", 1))
b"\xdai\x86\x8c\xde'\xbd\x8f2X\t\x8c\xce\xb1\xd0\x9ds\xd5\xc8P\x17V\xee;\\\xb2\xe7x*\xd7M\x98"

print(w3.eth.get_storage_at("0xa43028c702c3B119C749306461582bF647Fd770a", 2))
b'\x15\xee\xa4\xb2U\x1f\x0c\x96\xd0*]b\xf8L\xac\x81\x12i\rh\xc4{\x16\x81N"\x1b\x8a7\xd6\xc4\xd3'

print(w3.eth.get_storage_at("0xa43028c702c3B119C749306461582bF647Fd770a", 3))
b')>\xde\xa6acZ\xab\xcdm\xeb\xa6\x15\xab\x81:v\x10\xc1\xcf\xb9\xef\xb3\x1c\xccR$\xc0\xe4\xb3sr'
```

ç„¶åå†å°†åç¼–è¯‘ä»£ç ç¿»è¯‘ä¸º `python` è¿›è¡Œæ±‚è§£ï¼Œè¿™é‡Œå¡äº†ä¸€æ®µæ—¶é—´ï¼Œä¸»è¦æ˜¯æƒ³ä» `store3` å’Œ `store2` ç›´æ¥åæ¨å‡º `_param1` ä½†ç”±äºä¸­é—´æ˜¯æŒ‰ä½æˆ–ï¼Œå¯¼è‡´å€’æ¨å¾ˆå›°éš¾ï¼ŒåŸºæœ¬ä¸Šå¾ˆéš¾å¾—åˆ°ã€‚ã€‚ã€‚

ç„¶åæƒ³åˆ°æ¯æ¬¡è¿ç®—æ—¶ä¼šæ¯”ä¸Šæ¬¡å¤šå³ç§»4ä½ï¼Œæ‰€ä»¥å¯ä»¥ä»ä½ä½å¼€å§‹æ¯4ä½çˆ†ç ´ï¼Œæ¯æ¬¡åªéœ€ä»0åˆ°15ä¾æ¬¡æµ‹è¯•å³å¯ï¼Œä»£ç å¦‚ä¸‹ï¼š

```python

s2 = b'\x15\xee\xa4\xb2U\x1f\x0c\x96\xd0*]b\xf8L\xac\x81\x12i\rh\xc4{\x16\x81N"\x1b\x8a7\xd6\xc4\xd3'
s3 = b')>\xde\xa6acZ\xab\xcdm\xeb\xa6\x15\xab\x81:v\x10\xc1\xcf\xb9\xef\xb3\x1c\xccR$\xc0\xe4\xb3sr'


s2 = int.from_bytes(s2, "big")
s3 = int.from_bytes(s3, "big")

def func_0089(arg0, maxvar1):
    var0 = 0x00
    print(bin(arg0))
    for var1 in range(0, maxvar1):
        var0 = var0 | (((arg0 >> var1 * 0x04) + var1*0x05 + (s2>>var1*0x04)*0x07&0x0f)<<var1*0x04)
        print(f"var: {var0 & ((1<<4*(var1+1))-1)}\ns3: {s3 & ((1<<4*(var1+1))-1)}")
        if var0 & ((1<<4*(var1+1))-1) != s3 & ((1<<4*(var1+1))-1):
            return False
    return True
def calc():
    ans = 0

    for i in range(0, 64):
        print(f"calc i : {i}")
        for tmp in range(0, 16):
            if func_0089(ans + (tmp<<4*i), i+1):
                ans = ans + (tmp<<4*i)
                print(f"ans: {bin(ans)}")
                break
        else:
            print("error")
            exit(-1)
    return ans

ans = calc()
ans = ans.to_bytes((ans.bit_length()+7)//8, "big")

print(ans)
```



## ç¿»è½¦çš„è°œè¯­äºº

### FLAG1

åˆ©ç”¨ Wireshark æ‰“å¼€æµé‡åŒ…ï¼Œæœç´¢ `flag` å­—æ ·ï¼Œæ‰¾åˆ°ä¸€ä¸ª JSON æ ¼å¼çš„ HTTP è¯·æ±‚

![image-20211120155331187](WriteUp.assets/image-20211120155331187.png)

```json
{
    "name": "Untitled.ipynb", 
    "path": "Untitled.ipynb", 
    "last_modified": "2021-11-06T07:42:40.600988Z", 
    "created": "2021-11-06T07:42:40.600988Z", 
    "content": {
        "cells": [
            {
                "cell_type": "code", 
                "execution_count": 13, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "import zwsp_steg
from Crypto.Random import get_random_bytes"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 14, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "import binascii"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 15, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "def genflag():
    return 'flag{%s}'%binascii.hexlify(get_random_bytes(16)).decode()"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 16, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "flag1 = genflag()
flag2 = genflag()"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 17, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "key = get_random_bytes(len(flag1))"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 18, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [
                    {
                        "data": {
                            "text/plain": "b'\\xc4\\x07[\\xe5zy}b3\\x1aM\\xed\\t\\x14\\x1c\\xea\\x8f\\xfb\\xe52\\\\\\x80\\xb1\\x98\\x8a\\xb4\\xa6\\xdd;\\x92X\\x81\\xcd\\x86\\x86\\xc4\\xe0v'"
                        }, 
                        "execution_count": 18, 
                        "metadata": { }, 
                        "output_type": "execute_result"
                    }
                ], 
                "source": "key"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 19, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "def xor_each(k, b):
    assert len(k)==len(b)
    out = []
    for i in range(len(b)):
        out.append(b[i]^k[i])
    return bytes(out)"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 20, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "encoded_flag1 = xor_each(key, flag1.encode())
encoded_flag2 = xor_each(key, flag2.encode())"
            }, 
            {
                "cell_type": "code", 
                "execution_count": 22, 
                "metadata": {
                    "trusted": true
                }, 
                "outputs": [ ], 
                "source": "with open('flag2.txt', 'wb') as f:
    f.write(binascii.hexlify(encoded_flag2))"
            }
        ], 
        "metadata": {
            "kernelspec": {
                "display_name": "Python 3 (ipykernel)", 
                "language": "python", 
                "name": "python3"
            }, 
            "language_info": {
                "codemirror_mode": {
                    "name": "ipython", 
                    "version": 3
                }, 
                "file_extension": ".py", 
                "mimetype": "text/x-python", 
                "name": "python", 
                "nbconvert_exporter": "python", 
                "pygments_lexer": "ipython3", 
                "version": "3.8.3rc1"
            }
        }, 
        "nbformat": 4, 
        "nbformat_minor": 4
    }, 
    "format": "json", 
    "mimetype": null, 
    "size": 2502, 
    "writable": true, 
    "type": "notebook"
}
```

æ•´ç†åå¾—åˆ°ä¸€ä¸ª `.ipynb` æ–‡ä»¶ä¸­çš„ä»£ç ï¼Œè¿›è¡Œè¿˜åŸ

```python
from Crypto.Random import get_random_bytes

import binascii

def genflag():
    return "flag{%s}"%binascii.hexlify(get_random_bytes(16)).decode()

flag1=genflag()
flag2=genflag()

key = get_random_bytes(len(flag1))

key = b'\x1e\xe0[u\xf2\xf2\x81\x01U_\x9d!yc\x8e\xce[X\r\x04\x94\xbc9\x1d\xd7\xf8\xde\xdcd\xb2Q\xa3\x8a?\x16\xe5\x8a9'

def xor_each(k, b):
    out = []
    for i in range(len(b)):
        out.append(b[i]^k[i])
    return bytes(out)

encode_flag2 = xor_each(key, flag2.encode())


with open('flag2.txt') as f:
    encode_flag2 = f.write()
```

æ³¨æ„ï¼Œä¸Šé¢çš„ key å’Œæˆªå›¾ä¸­çš„ä¸ä¸€è‡´ï¼Œä¸»è¦æ˜¯ç”±äºè¿™ä¸ªæ•°æ®æ¯”è¾ƒè€ï¼Œåœ¨æµé‡ä¸­è¿˜èƒ½æ‰¾åˆ°æ–°çš„ `Untitled.ipynb` æ–‡ä»¶ï¼Œè¿™ä¸ª key æ˜¯ä»æ–°çš„æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ã€‚

ç„¶åç»§ç»­åœ¨æµé‡ä¸­æ‰¾ `flag1` 

![image-20211120161757633](WriteUp.assets/image-20211120161757633.png)

å¯ä»¥å¾—åˆ° `flag1.txt` çš„å†…å®¹ï¼Œç„¶åè®¡ç®—å³å¯ã€‚

```python
flag1="788c3a1289cbe5383466f9184b07edac6a6b3b37f78e0f7ce79bece502d63091ef5b7087bc44"

key = b'\x1e\xe0[u\xf2\xf2\x81\x01U_\x9d!yc\x8e\xce[X\r\x04\x94\xbc9\x1d\xd7\xf8\xde\xdcd\xb2Q\xa3\x8a?\x16\xe5\x8a9'

def xor_each(k, b):
    out = []
    for i in range(len(b)):
        out.append(b[i]^k[i])
    return bytes(out)

flag1 = xor_each(key, bytes.fromhex(flag1))
print(flag1)
```

### FLAG2

åœ¨æµé‡ä¸­æœç´¢ `flag2` å¯ä»¥çœ‹åˆ°ä¸€ä¸ª HTTP ä¼ è¾“çš„å‹ç¼©åŒ…ï¼Œä¿å­˜ä¸‹æ¥åè§£å‹å‘ç°æœ‰å¯†ç ï¼Œç»§ç»­åœ¨æµé‡ä¸­æœç´¢ `flag2` å‘ç°äº† `websocket` åŒ…

![image-20211120162949203](WriteUp.assets/image-20211120162949203.png)

åœ¨é‡Œé¢çœ‹åˆ°äº†å‹ç¼©åŒ…æ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Œè¿˜åŸå¯†ç ä¸º

Wakarimasu! \`date\` \`uname -nom\` \`nproc\`

> markdown å¥½éš¾å†™è¿™ä¸ªå¯†ç ï¼Œè¿˜æ˜¯çœ‹æˆªå›¾å§

![image-20211120162148087](WriteUp.assets/image-20211120162148087.png)

`date` æ˜¯å½“æ—¶çš„æ—¥æœŸæ—¶é—´ï¼Œåœ¨æµé‡åŒ…ä¸­æ‰¾åˆ°è¯¥å‹ç¼©åŒ…çš„ç”Ÿæˆæ—¶é—´ä¸º`2021-11-06T07:44:16`ï¼Œæˆ‘åœ¨ wsl2 è™šæ‹Ÿæœºä¸Šå°†æ—¶é—´è°ƒæ•´åˆ° 6 å·æ‰§è¡Œ `date` å‘½ä»¤å¾—åˆ°å¦‚ä¸‹æ ¼å¼`Sat  6 Nov 2021 21:10:11 CST` 

`uname -nom` å¾—åˆ° `vm x86_64 GNU/Linux` å…¶ä¸­ `vm` æ˜¯æˆ‘çš„è™šæ‹Ÿæœºåï¼Œåœ¨ websocket åŒ…ä¸­å¯ä»¥æ‰¾åˆ° You é…±çš„è™šæ‹Ÿæœºåï¼Œç¬¬äºŒé¡¹æ˜¯å¤„ç†å™¨æ¶æ„ï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯64ä½æœºï¼Œç¬¬ä¸‰é¡¹æ˜¯ç³»ç»Ÿç›¸å…³ã€‚

`nproc` æ˜¯å¤„ç†å™¨çº¿ç¨‹æ•°ï¼Œåœ¨ websocket åŒ…ä¸­å¯ä»¥çœ‹åˆ° You é…±çš„è™šæ‹Ÿæœºæ˜¯ 8çº¿ç¨‹çš„ 

äºæ˜¯å¾—åˆ°å¯†ç ä¸º `Wakarimasu! Sat  6 Nov 2021 07:44:16 CST you-kali-vm x86_64 GNU/Linux 8` æ”¹åŠ¨çš„åœ°æ–¹åªæœ‰ç§’ä½éœ€è¦ï¼Œç»“æœå°è¯•äº†å¾ˆä¹…éƒ½æ— æ³•è§£å‹æˆåŠŸï¼Œä¸€åº¦æ€€ç–‘æ˜¯å‹ç¼©åŒ…æœ‰é—®é¢˜ï¼Œè¿˜å°è¯•äº†ä¿®å¤å‹ç¼©åŒ…ã€‚ã€‚ã€‚

ç›´åˆ°ç¬¬äºŒé˜¶æ®µæç¤ºæ”¾å‡ºåï¼Œæ‰çŸ¥é“æ˜¯ `date` éƒ¨åˆ†é”™äº†ï¼Œæ­£ç¡®çš„å¯†ç æ˜¯`Wakarimasu! Sat 06 Nov 2021 03:44:15 PM CST you-kali-vm x86_64 GNU/Linux 8`

è§£å‹åå¾—åˆ°ä¸€ä¸ª `.wav` æ–‡ä»¶ï¼Œé€šè¿‡ websocket åŒ…å¾—çŸ¥ï¼Œè¯¥æ–‡ä»¶æ˜¯ç”¨ `stegolsb` å°† `flag2.txt` éšå†™è¿›å»å¾—åˆ°çš„

![image-20211120163112934](WriteUp.assets/image-20211120163112934.png)

äºæ˜¯ä½¿ç”¨å‘½ä»¤`stegolsb wavsteg -r -i xxx.wav -o encode_flag2.txt -n 1 -b 76` å…¶ä¸­çš„ `-n` å‚æ•°å’Œ `-b` å‚æ•°æ˜¯åœ¨ websocket åŒ…ä¸­å¾—åˆ°çš„ã€‚

é‡å¤ FLAG1 ä¸­çš„è§£å¯†æ­¥éª¤å³å¯å¾—åˆ° FLAG2

## åœ¨çº¿è§£å‹ç½‘ç«™

é€šè¿‡åˆ†ææºç å¯ä»¥çœ‹åˆ°ï¼Œå½“è®¿é—®è·¯å¾„æ˜¯æ–‡ä»¶æ—¶ï¼Œä¼šè¿”å›è¯¥æ–‡ä»¶å¯¹åº”çš„å†…å®¹ã€‚è€Œ FLAG è—åœ¨æ ¹ç›®å½•ä¸‹ï¼Œäºæ˜¯çŒœæµ‹æ˜¯å¦å¯ä»¥åˆ©ç”¨Linuxä¸‹çš„è½¯é“¾æ¥è¯»å–flagï¼Œ

```bash
touch /flag
ln -s /flag ./test
```

ç„¶åå‹ç¼© `test` æ–‡ä»¶å†ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œç¡®å®èƒ½å¾—åˆ° FLAG



## æ—©æœŸäººç±»çš„èŠå¤©å®¤

ç¬¬ä¸€é˜¶æ®µæœªè§£å‡ºæ¥ä½†åˆ†æäº†å¾ˆå¤šï¼Œç¬¬äºŒé˜¶æ®µçœ‹åˆ°æç¤ºåå³è§£ã€‚

é¦–å…ˆåˆ†ææºç å‘ç°å¯ä»¥ä»»æ„è¯»å–æ–‡ä»¶ï¼Œåªéœ€è¦åœ¨å‚æ•°ä¸Šæ‹¼æ¥è¶³å¤Ÿçš„`../`å³å¯è®¿é—®åˆ°æ ¹ç›®å½•ï¼Œå°è¯•ç›´æ¥è¯»å– flag å¤±è´¥ï¼Œåº”è¯¥æ˜¯æ²¡æœ‰æƒé™ã€‚

åˆ©ç”¨ linux ä¸Šçš„ `/proc` ç›®å½•è¯»å–è‡ªèº«çš„ `cmdline` å¾—åˆ° uwsgi é…ç½®æ–‡ä»¶è·¯å¾„ï¼Œè®¿é—®è¯¥æ–‡ä»¶å‘ç°æœåŠ¡å™¨çš„è¿›ç¨‹çš„æƒé™æ˜¯ `nobody` ï¼Œè¿™æ—¶æƒ³ç€èƒ½å¦ææƒï¼Œå°è¯•äº†å¾ˆå¤šåŠæ³•éƒ½ä¸è¡Œï¼Œå¡ä½ã€‚ã€‚ã€‚

åœ¨å¡ä½çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘éå†äº† `pid` å¾—çŸ¥æœåŠ¡å™¨æ˜¯ç”¨ supervisor å¯åŠ¨çš„ï¼Œäºæ˜¯æƒ³åˆ°èƒ½å¦æ›´æ”¹ uwsig é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯ uwsgi è¿›ç¨‹å°±èƒ½ææƒï¼Œä½†è¿«äºæ— æ³•å†™å…¥ uwsgi é…ç½®æ–‡ä»¶ï¼Œä¸”æ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œå¡ä½ã€‚ã€‚ã€‚

ç¬¬äºŒé˜¶æ®µçœ‹åˆ°æç¤ºåï¼Œæ‰çŸ¥é“è¦åˆ©ç”¨ uwsgi çš„ rce ï¼Œå•Šè¿™ğŸ¤¯ï¼Œç”¨äº†å¥½å‡ å¹´çš„ uwsgi éƒ½ä¸çŸ¥é“æœ‰æ¼æ´ã€‚ã€‚ã€‚

äºæ˜¯ä½¿ç”¨æœåŠ¡å™¨å‘é€æ¶ˆæ¯é¡µé¢ï¼Œå°†åœ°å€æ”¹ä¸º `127.0.0.1:3031` ï¼Œè¿™ä¸ªç«¯å£å·æ˜¯ä¸Šé¢é€šè¿‡è¯»å– uwsgi  é…ç½®æ–‡ä»¶å¾—åˆ°çš„ã€‚

ç„¶åä½¿ç”¨ [uwsgi_exp.py](https://github.com/wofeiwo/webcgi-exploits/blob/master/python/uwsgi_exp.py) æ„é€  payloadï¼Œ é¦–å…ˆä¿®æ”¹ uwsgi é…ç½®æ–‡ä»¶

```
echo '[uwsgi]
socket = :3031
chdir = /usr/src/ufctf
manage-script-name = true
mount = /=app:app
master = true
uid = root
gid = root
workers = 2
buffer-size = 65535
enable-threads = true
pidfile = /tmp/uwsgi.pid
' >/tmp/uwsgi-ctf.ini
```

ç”±äº uwsgi è¿›ç¨‹æƒé™å¾ˆä½ï¼Œåˆ›å»ºæ–°è¿›ç¨‹è¿˜æ˜¯ `nobody` æ‰€ä»¥åªèƒ½è€ƒè™‘é‡å¯ uwsgi è¿›ç¨‹ï¼Œå°è¯•äº†`uwsgi --reload /tmp/uwsgi.pid` å‘ç°å¹¶æ²¡æœ‰ææƒæˆåŠŸï¼Œäºæ˜¯ä½¿ç”¨ `uwsgi --stop /tmp/uwsgi.pid` ~~(æˆ‘è‡ªå·±åœæ­¢æˆ‘è‡ªå·±æ€»è¡Œäº†å§)~~ï¼Œå€ŸåŠ©äº supervisor è¿™ä¸ªè¿›ç¨‹ç®¡ç†å™¨æˆåŠŸå¾—åˆ°æ–°çš„ root æƒé™çš„ uwsgi è¿›ç¨‹ï¼Œç„¶åç›´æ¥è¯»å– `/flag` å³å¯ã€‚



## Flag å³æœåŠ¡

### Flag0

å¡äº†å¾ˆä¹…ï¼Œä¸»è¦æ˜¯æœåˆ°äº† RFC 3986ï¼Œ ä»¥ä¸ºæµè§ˆå™¨å’Œå„ç§å‘é€è¯·æ±‚çš„å·¥å…·éƒ½ä¼šéµå¾ªï¼Œåæ¥å¶ç„¶å‘ç° Postman å¹¶æ²¡æœ‰éµå¾ªè¯¥æ ‡å‡†ã€‚ã€‚ã€‚äºæ˜¯åˆ©ç”¨ Postman è®¿é—® `/api/../package.json`  å¾—åˆ° `package.json` æ–‡ä»¶ï¼Œä»æ–‡ä»¶ä¸­å¾—åˆ° `jsonaas-backend` çš„ä¸‹è½½é“¾æ¥ï¼Œä»è€Œå¾—åˆ°æºç ã€‚

é˜…è¯»æºç ï¼Œå‘ç°å¯¹ `FLAG0` æœ‰ç‰¹æ®Šçº¦æŸ

```js
FLAG0===`flag{${0.1+0.2}$}`
```

åœ¨æµè§ˆå™¨ä¸­æ‰§è¡Œ 0.1+0.2 å³å¯å¾—åˆ° FLAG0

### FLAG1 å’Œ FLAG2

å°è¯•äº†å¾ˆå¤šæ–¹æ³•éƒ½ä¸è¡Œï¼Œç®€å•è¯´ä¸‹è‡ªå·±å°è¯•è¿‡çš„æ€è·¯ã€‚

FLAG2 åº”è¯¥æ˜¯ vm æ²™ç›’é€ƒé€¸ï¼Œè€Œä¸”ç”±äºä»£ç ä¸­åªæ˜¯åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ `unlink` äº†`flag2.txt` æ‰€ä»¥è¿˜æ˜¯å¯ä»¥ç”¨å…¶ä»–æ–¹æ³•è¯»å–çš„ã€‚

FLAG1 å°è¯•äº† `session` ä¼ªé€ ï¼Œå‘ç°è¡Œä¸é€šï¼›å°è¯•æ„é€  `req.query` ç»•è¿‡éªŒè¯å¤±è´¥ã€‚

é™å¾…å¤§ç¥ä»¬çš„ WP



## è¯¡å¼‚çš„ç½‘å…³

<u>è¿™é¢˜æˆ‘åº”è¯¥æ˜¯éé¢„æœŸè§£ğŸ˜Š</u>

æ‰“å¼€è½¯ä»¶åéšä¾¿ç‚¹ç‚¹å‘ç°æœ‰ä¸ªç”¨æˆ·åå« `flag` ä¸”å¯†ç ä»¥æ˜Ÿå·è¡¨ç¤ºï¼Œäºæ˜¯åœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªèƒ½ç”¨çš„[æ˜Ÿå·æŸ¥çœ‹å™¨](WriteUp.assets/peekPassword.zip) è§£å‹å¯†ç `geekgame` ~~ä¸åŠ å¯†ä¼šæŠ¥æ¯’ç„¶åç›´æ¥è¢«åˆ é™¤~~ã€‚ã€‚ã€‚ç„¶åå°±å¾—åˆ°äº† FLAG

![image-20211120164942900](WriteUp.assets/image-20211120164942900.png)

é™å¾…å¤§ç¥ä»¬çš„ WP



## å¯†ç å­¦å®è·µ

> è¿™é¢˜å‡ºçš„å¤ªå¥½äº†ï¼

### FLAG1

é˜…è¯»ä»£ç å‘ç°å’Œ Richard è°ˆè¯æ—¶ï¼Œ FLAG1 ä¼šç›´æ¥æ‹¼æ¥åœ¨å·²çŸ¥æ˜æ–‡åå†åŠ å¯†å‘é€ç»™æˆ‘ä»¬ï¼Œäºæ˜¯æŸ¥çœ‹åŠ å¯†ç®—æ³•ï¼Œæ‰‹æ¨åŠ å¯†å¾ªç¯å‘ç°ï¼Œå¯†æ–‡å’Œæ˜æ–‡ä¹‹é—´å…³ç³»è¾ƒä¸ºç®€å•ã€‚

å¦‚æœå·²çŸ¥æ˜æ–‡å’Œå¯†æ–‡ï¼Œå¯ä»¥å€’æ¨å‡ºåŠ å¯†ä½¿ç”¨çš„keyï¼Œç„¶åå†åˆ©ç”¨å¾—åˆ°çš„keyï¼Œè§£å¯† FLAG éƒ¨åˆ†çš„å¯†æ–‡ã€‚

ä»£ç å¦‚ä¸‹ï¼š

```python
from Crypto.Util.number import bytes_to_long, long_to_bytes


def get(mess: bytes, oristr: bytes):
    pmess = mess[0:32]
    a0 = bytes_to_long(pmess[0:8])
    b0 = bytes_to_long(pmess[8:16])
    c0 = bytes_to_long(pmess[16:24])
    d0 = bytes_to_long(pmess[24:32])

    o0 = bytes_to_long(oristr[0:8])
    o1 = bytes_to_long(oristr[8:16])
    o2 = bytes_to_long(oristr[16:24])
    o3 = bytes_to_long(oristr[24:32])

    ka = c0 ^ a0 ^ o0
    kb = d0 ^ b0 ^ o1
    kc = a0 ^ o2
    kd = b0 ^ o3

    ori = b""
    for it in range(32, len(mess), 32):
        pmess = mess[it:it+32]
        a1 = bytes_to_long(pmess[0:8])
        b1 = bytes_to_long(pmess[8:16])
        c1 = bytes_to_long(pmess[16:24])
        d1 = bytes_to_long(pmess[24:32])
        a, b, c, d = c1^a1^ka, d1^b1^kb, a1^kc, b1^kd

        a = long_to_bytes(a, 8)
        b = long_to_bytes(b, 8)
        c = long_to_bytes(c, 8)
        d = long_to_bytes(d, 8)

        ori += a+b+c+d
        print(ori)


def pad(msg):
    n = 32 - len(msg) % 32
    return msg + bytes([n]) * n


enc = bytes.fromhex("f5b658a1fa3f7740e0c0a8bc67077fd1aaebaec98bfddb0f3a5e32b9fd3f8fa7f1ab14a4a9623e50e981b6a854423af589b3e8ccd6ebc1707f2227adcf3cead1ddbe5a92950f584b8de8d9db1a2f03aebee38cc9e58480320b4d4be4ef52899c")

get(enc, pad("Hello, Alice! I will give you two flags. The first is: ".encode("utf-8")))

```

### FLAG2

åŸç†åº”è¯¥æ˜¯é€‰æ‹©å¯†æ–‡æ”»å‡»

é˜…è¯»ä»£ç ï¼Œæˆ‘ä»¬å‘ç° God ä¼šå¯¹æˆ‘ä»¬çš„ name å’Œ key åŠ å¯†è¿”å› certï¼Œè€Œ Richard ä¼šéªŒè¯æˆ‘ä»¬çš„ cert å½“ name æ˜¯ Alice æ—¶ç»™æˆ‘ä»¬å‘é€ FLAG2ã€‚ä½† God å·²ç»åŠ å¯†è¿‡ name æ˜¯ Alice çš„ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¾“å…¥ name æ˜¯ Alice ä¼šè¢«æ‹’ç»ã€‚

ç”±äº Richard åªéªŒè¯ name ï¼Œäºæ˜¯æˆ‘ä»¬è€ƒè™‘åˆ¶é€  name ä¸º Aliceï¼Œkey éšæ„çš„æ˜æ–‡å¯¹åº”çš„å¯†æ–‡ã€‚

è§‚å¯Ÿ God ç­¾å‘è¿‡ç¨‹ï¼Œé¦–å…ˆä¼šå°† name å’Œ key è¿›è¡Œ packmess ç„¶åæ‹¼æ¥èµ·æ¥å†ä½¿ç”¨ rsa åŠ å¯†ã€‚

æˆ‘ä»¬è€ƒè™‘æœ€ç®€å•çš„æƒ…å†µï¼Œå³æˆ‘ä»¬æƒ³è¦çš„æ˜¯ `Alice\x00\x05\x00\x00` è¿™æ ·çš„æ˜æ–‡å¯¹åº”çš„ certï¼Œäºæ˜¯æˆ‘ä»¬è€ƒè™‘å‘é€ç»™Godçš„ name ä¸ºç©ºï¼Œè¿™æ · God å‘é€çš„ cert çš„æ˜æ–‡å°±æ˜¯ key å’Œ keyçš„é•¿åº¦ æ‹¼æ¥èµ·æ¥ã€‚
$$
æˆ‘ä»¬éœ€è¦\ C\ ä½¿å¾—\ M=C^e\mod N \\
å…¶ä¸­\ M=Alice\backslash x00\backslash x05\backslash x00\backslash x00 \\
æˆ‘ä»¬é€‰æ‹©ä»»æ„çš„\ X ä¸\ N äº’ç´ ï¼ˆä¸ºäº†ç®€å•å¯ä»¥é€‰ X=3 \ )\\
æˆ‘ä»¬è®¡ç®—\ Y=M*X^e\mod N \\
å°†\ Y\ å‘é€ç»™æœåŠ¡å™¨è®¡ç®—\ Z=Y^d\mod N=M^d * X^{e*d}\mod N=C*X \mod N \\
ç°åœ¨æˆ‘ä»¬çŸ¥é“Zã€Xï¼Œè®¡ç®—Cåªéœ€è¦ä½¿å¾— (Z+iN)\%X==0 å³å¯
$$
**æ³¨æ„âš ï¸ï¼šåœ¨æ„é€ å‡º Y åï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯ Y è½¬æ¢æˆ bytes çš„é•¿åº¦å‡å»2è¦å°äº Y çš„bytesçš„æœ€åä¸¤ä¸ªå­—èŠ‚è½¬æ¢æˆçš„æ•°å­—å¤§å°ï¼Œä¸”å‘é€ç»™æœåŠ¡å™¨çš„ Y åº”æ˜¯ Y è½¬åŒ–æˆ bytes åçš„å‰**

ä»£ç å¦‚ä¸‹ï¼š

```python
from re import T
from pwn import *
from Crypto.Util.number import bytes_to_long,long_to_bytes
import binascii
from rsa import *
import gmpy2

r = connect("prob08.geekgame.pku.edu.cn", 10008)
r.sendlineafter(b"Please input your token:\n", b"Your Token")

print(r.recvline())  # What do you want to do?
print(r.recvline())  # 0. Talk to God.
print(r.recvline())  # 1. Talk to Richard.
r.sendline(b"0")
N = int(r.recvline().split()[-1].decode("utf-8"))  # My RSA N is: 
e = int(r.recvline().split()[-1].decode("utf-8"))  # My RSA e is: 
print("N: ", N)
print("e: ", e)

p = int.from_bytes(b"Alice\x00\x05\x00\x00", "big")
print(f"p: {p}")
x = 3
while True:
    tmp = p*pow(x, e, N) % N
    y = tmp.to_bytes((tmp.bit_length()+7)//8, "big")
    rlen = int.from_bytes(y[-2:], "big")
    if len(y)-2 > rlen:
        x+=1
        continue
    else:
        print(f"x:{x} y:{y}")
        break

y = b'\x00'*(rlen-len(y)+2) +y
y = y[-(2+rlen):-2]

print(r.recvline())  # What is your name?
r.sendline(b"")
print(b"")
print(r.recvline())  # What is your key?
r.sendline(y.hex().encode("utf-8"))
print(y)
print(r.recvline())  # Your certificate is:
fakecert = r.recvline().strip()
print(fakecert)
fakecert = int(fakecert.decode("utf-8"))
mess=pow(fakecert,e,N)
mess=mess.to_bytes((mess.bit_length()+7)//8,'big')
print("mess: ", mess)

i = 0
while True:
    tmp = fakecert + N*i
    if tmp % x == 0:
        break
    i += 1

C = (fakecert + N*i) // x
print(f"C: {C}")
mess=pow(C,e,N)
messm=mess.to_bytes((mess.bit_length()+7)//8,'big')
print(f"Hacked! {messm}")



print(r.recvline())  # What do you want to do?
print(r.recvline())  # 0. Talk to God.
print(r.recvline())  # 1. Talk to Richard.

r.sendline(b"1")
flag1enc = r.recvline() # Hello, Alice! I will give you two flags. The first is: 
notice_mess_enc =  r.recvline()  # Sorry, I forget to verify your identity. Please give me your certificate.

r.sendline(str(C).encode("utf-8"))

flag2enc = r.recvline() # I can give you the second flag now. It is: 
print(flag2enc)
# print(get_flag2(flag2enc))


r.close()
```



## å¶å­çš„æ–°æ­Œ

å¥—å¨ƒå¿ƒæ€ç‚¸æ‰ã€‚ã€‚

é¦–å…ˆä¸‹è½½ä¸‹æ¥ï¼Œåœ¨macä¸Šä¼šè‡ªåŠ¨æ’­æ”¾å‘ç°æ²¡å•¥ä¸œè¥¿ï¼Œä½¿ç”¨éŸ³é¢‘åˆ†æè½¯ä»¶ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆï¼Œè€½è¯¯äº†å¥½ä¹…ï¼Œåæ¥åœ¨windowsä¸Šæ’­æ”¾æ—¶å‘ç°å³ä¸Šè§’æœ‰æç¤º`Secret in Album Cover` ï¼Œäºæ˜¯ä½¿ç”¨ potplayer æå–å‡ºå°é¢å›¾ç‰‡ï¼Œç„¶åä½¿ç”¨ stegosolove æ‰¾å‡ºä½¿ç”¨ lsb éšå†™è¿›å»çš„ä¸€ä¸ª png æ–‡ä»¶ï¼Œè¯¥ png æ–‡ä»¶é•¿å¾—ç±»ä¼¼äºŒç»´ç ï¼Œå¡ä½ã€‚ã€‚ã€‚ç„¶ååœ¨linux ä¸‹ä½¿ç”¨ binwalk å‘ç°æœ‰ä¸ªå‹ç¼©åŒ…ï¼Œä½¿ç”¨ `binwalk -e ` å¤„ç†åå¾—åˆ°ä¸€ä¸ª `MIPSEL-BE ECOFF executable stripped -version 0.0` çš„æ–‡ä»¶ï¼Œå°è¯•ä½¿ç”¨ qemu è¿è¡Œæ— æœï¼Œå¡ä½ã€‚ã€‚ã€‚

## Q å°æ ‘æ´çš„ä¸€å¤§æ­¥

åœ¨ä½¿ç”¨äº†ç°ä»£åŒ–æ¡†æ¶ React åçš„ç½‘ç«™æ‰¾ XSS çœŸéš¾å•Šã€‚ã€‚ã€‚å°è¯•äº†å¾ˆå¤šæ–¹æ³•éƒ½æ— æ³•åœ¨ç½‘é¡µä¸Šæ„å»º XSSã€‚

ç¬¬äºŒé˜¶æ®µçœ‹åˆ°æç¤ºåï¼Œåˆå°è¯•äº†å¾ˆå¤šæ–¹æ³•ï¼Œè¿˜æ˜¯è¡Œä¸é€šã€‚~~æˆ‘ç”šè‡³é€è¡Œæ¯”å¯¹äº† Qå°æ ‘æ´å’Œ PKUæ ‘æ´ç°åœ¨çš„ js æ–‡ä»¶ï¼Œè¿˜æ˜¯æ²¡æœ‰ä»»ä½•å‘ç°ã€‚~~

å®¡è®¡ä»£ç ä¸­å‘ç°è®¿é—® `/hole/#//setflag flag1=content` ä¼šå°† `LocalStorage` ä¸­çš„ `flag1` è®¾ç½®ä¸º `content` ï¼Œä½†å¹¶ä¸ä¼šè§¦å‘ä»£ç æ‰§è¡Œï¼Œä¸”ç”±äºä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºæ¡†ï¼Œå°†å¯¼è‡´ XSSBOT æ— æ³•ç»§ç»­æ‰§è¡Œã€‚ã€‚

è¿˜å‘ç° `LocalStorage` ä¸­çš„ `APPSWITCHER_ITEMS` ä¸­æœ‰ä¸€é¡¹ `fix` ä¼šè¢«  `eval` è¯­å¥æ‰§è¡Œï¼Œä½†ç”±äºè·¨åŸŸè¦æ±‚ï¼Œæ— æ³•åœ¨å…¶ä»–ç«™ç‚¹ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œæ— æ³•åˆ©ç”¨è¿™ä¸ªç‚¹ã€‚

é™å¾…å¤§ç¥ä»¬çš„ WP

## å°„æ‰‹é±¼

`.debug` æ–‡ä»¶å®Œå…¨ä¸æ‡‚ï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP

## å­—ç¬¦ä¸²è½¬ä¹‰

ç¬¬ä¸€é˜¶æ®µæƒ³åˆ°äº†è®¡ç®— canaryï¼Œç„¶åè°ƒç”¨`print_flag`ä½†æ²¡åŠ¨åŠ›åšï¼Œä¹‹å‰å®Œå…¨æ²¡åšè¿‡ğŸ˜®â€ğŸ’¨ï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP

## æœ€å¼ºå¤§è„‘

ä¸çŸ¥é“ä¸ºä»€ä¹ˆè¿›å…¥`compile_code()` ç¼–è¯‘çš„åŒºåŸŸåä¼š`segment fault` ï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP

## ç”µå­æ¸¸æˆæ¦‚è®º

çœ‹ç€æ²¡äººåšå‡ºæ¥ï¼Œå°±æ²¡çœ‹ï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP

## æ‰«é›·

ç»ƒäº†ä¸€ä¸ª Qlearning ä½†æ•ˆæœä¸è¡Œï¼Œä¸å¤ªæƒ³è°ƒå‚ï¼Œæ”¾å¼ƒï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP

## é¾™ç æ¨¡æ‹Ÿå™¨

åº”è¯¥æ˜¯è€ƒå¯Ÿ java é‡Œçš„ Random ç±»ï¼Œå¯¹ java ä¸ç†Ÿå¯¹ç®—æ³•ä¹Ÿä¸ç†Ÿï¼Œæ”¾å¼ƒï¼Œé™å¾…å¤§ç¥ä»¬çš„ WP











